# 学生管理系统 - 技术规约文档

## 1. 技术架构

### 1.1 系统架构
- **学生端**：纯静态网页，从JSON文件获取所有数据
- **教师端**：本地应用，可将所有数据导出为JSON文件供学生端使用

### 1.2 技术栈
- **前端框架**：React 18+ with TypeScript
- **UI组件库**：Ant Design (TypeScript版本)
- **构建工具**：Vite
- **Excel处理**：SheetJS/xlsx库
- **路由管理**：React Router DOM
- **状态管理**：React Hooks (useState/useEffect)

## 2. JSON数据结构定义

### 2.1 学生数据 (students.json)
```json
{
  "students": [
    {
      "id": "uuid",
      "class": "高一(1)班",
      "name": "张三",
      "studentId": "2024001",
      "createdAt": "2024-01-01T00:00:00Z",
      "updatedAt": "2024-01-01T00:00:00Z"
    }
  ]
}
```

### 2.2 考试排名数据 (examRankings.json)
```json
{
  "rankings": [
    {
      "id": "uuid",
      "studentId": "uuid",
      "examName": "期中考试",
      "ranking": 1,
      "createdAt": "2024-01-01T00:00:00Z"
    }
  ]
}
```

### 2.3 标准设置数据 (standards.json)
```json
{
  "standards": [
    {
      "id": "uuid",
      "studentId": "uuid",
      "name": "作业标准",
      "value": 5,
      "createdAt": "2024-01-01T00:00:00Z",
      "updatedAt": "2024-01-01T00:00:00Z"
    }
  ]
}
```

### 2.4 违规记录数据 (violations.json)
```json
{
  "violations": [
    {
      "id": "uuid",
      "studentId": "uuid",
      "type": "迟到",
      "violationDate": "2024-01-01T00:00:00Z",
      "createdAt": "2024-01-01T00:00:00Z"
    }
  ]
}
```

### 2.5 完整数据包 (data.json)
```json
{
  "students": [...],
  "rankings": [...],
  "standards": [...],
  "violations": [...]
}
```

## 3. 代码规范和命名约定

### 3.1 文件命名
- **组件文件**：PascalCase (e.g., TeacherLogin.tsx)
- **工具文件**：camelCase (e.g., api.ts)
- **类型定义文件**：PascalCase with .types.ts suffix (e.g., User.types.ts)
- **样式文件**：kebab-case (e.g., teacher-login.css)

### 3.2 变量命名
- **组件状态**：camelCase (e.g., isLoading)
- **常量**：UPPER_CASE with underscores (e.g., API_BASE_URL)
- **函数**：camelCase (e.g., handleLogin)
- **类型**：PascalCase (e.g., StudentProps)

### 3.3 代码风格
- **缩进**：2个空格
- **分号**：必须使用
- **引号**：单引号
- **换行**：每行不超过120个字符
- **注释**：使用JSDoc风格注释

## 4. 开发环境配置

### 4.1 前端开发环境
- **Node.js**：v18.0.0+
- **npm**：v9.0.0+
- **TypeScript**：v5.0.0+
- **Vite**：v5.0.0+

### 4.2 依赖安装
```bash
# 安装核心依赖
npm install react react-dom react-router-dom antd @ant-design/icons

# 安装开发依赖
npm install -D typescript @types/react @types/react-dom @types/react-router-dom vite @vitejs/plugin-react

# 安装Excel处理依赖
npm install xlsx
```

### 4.3 构建配置 (vite.config.ts)
```typescript
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';

export default defineConfig({
  plugins: [react()],
  resolve: {
    alias: {
      '@': '/src'
    }
  },
  build: {
    outDir: 'dist',
    assetsDir: 'assets',
    minify: 'terser',
    sourcemap: false
  }
});
```

## 5. 前端架构设计

### 5.1 目录结构
```
src/
├── pages/
│   ├── StudentLogin.tsx
│   ├── TeacherLogin.tsx
│   ├── StudentProfile.tsx
│   ├── StudentViolation.tsx
│   ├── StudentRanking.tsx
│   └── teacher/
│       ├── ClassManagement.tsx
│       ├── StudentManagement.tsx
│       ├── RankingManagement.tsx
│       ├── StandardView.tsx
│       ├── StandardManagement.tsx
│       ├── ViolationManagement.tsx
│       ├── AlertManagement.tsx
│       └── DataExport.tsx
├── components/
│   ├── common/
│   └── teacher/
├── services/
│   ├── api.ts
│   └── mockData.ts
├── types/
│   └── index.ts
├── utils/
│   └── index.ts
└── layouts/
    └── TeacherLayout.tsx
```

### 5.2 模拟数据结构 (mockData.ts)
```typescript
// 模拟学生数据
export const mockStudents = [
  {
    id: '1',
    class: '高一(1)班',
    name: '张三',
    studentId: '2024001',
    createdAt: '2024-01-01T00:00:00Z',
    updatedAt: '2024-01-01T00:00:00Z'
  }
];

// 模拟考试排名数据
export const mockRankings = [
  {
    id: '1',
    studentId: '1',
    examName: '期中考试',
    ranking: 1,
    createdAt: '2024-01-01T00:00:00Z'
  }
];

// 模拟标准设置数据
export const mockStandards = [
  {
    id: '1',
    studentId: '1',
    name: '作业标准',
    value: 5,
    createdAt: '2024-01-01T00:00:00Z',
    updatedAt: '2024-01-01T00:00:00Z'
  }
];

// 模拟违规记录数据
export const mockViolations = [
  {
    id: '1',
    studentId: '1',
    type: '迟到',
    violationDate: '2024-01-01T00:00:00Z',
    createdAt: '2024-01-01T00:00:00Z'
  }
];
```

## 6. API接口规范

### 6.1 教师端API接口
- **登录接口**：POST /api/auth/teacher/login
- **获取学生列表**：GET /api/students
- **获取考试排名**：GET /api/rankings
- **获取标准设置**：GET /api/standards
- **获取违规记录**：GET /api/violations
- **导出数据**：GET /api/export/data

### 6.2 响应格式
```json
{
  "success": true,
  "message": "操作成功",
  "data": { /* 响应数据 */ }
}
```

## 7. 模拟数据使用规范

### 7.1 模拟数据位置
- 学生端：src/services/mockData.ts
- 教师端：src/services/mockData.ts

### 7.2 模拟数据替换策略
1. 开发阶段使用模拟数据
2. 集成阶段替换为真实JSON文件
3. 确保模拟数据结构与真实JSON结构完全一致

## 8. 代码质量保证

### 8.1 ESLint配置
```json
{
  "extends": [
    "eslint:recommended",
    "plugin:@typescript-eslint/recommended",
    "plugin:react/recommended"
  ],
  "rules": {
    "react/prop-types": "off",
    "@typescript-eslint/explicit-module-boundary-types": "off"
  }
}
```

### 8.2 测试策略
- **单元测试**：使用Jest测试框架
- **集成测试**：使用React Testing Library
- **E2E测试**：使用Cypress

## 9. 版本控制策略

### 9.1 Git分支管理
- **main**：主分支，用于生产环境
- **develop**：开发分支，用于集成测试
- **feature/**：功能分支，用于开发新功能
- **bugfix/**：修复分支，用于修复bug

### 9.2 提交规范
- **feat**：新功能
- **fix**：修复bug
- **docs**：文档更新
- **style**：代码风格
- **refactor**：代码重构
- **test**：测试代码
- **chore**：构建或依赖更新

## 10. 技术风险评估

### 10.1 潜在风险
- **数据同步**：教师修改数据后需要手动更新JSON文件
- **数据安全**：JSON文件可能包含敏感信息
- **性能优化**：大数据量下的加载性能
- **Cloudflare部署**：配置和缓存策略

### 10.2 风险缓解措施
- **数据版本管理**：使用Git管理JSON文件版本
- **数据加密**：对敏感信息进行加密处理
- **懒加载**：实现数据懒加载机制
- **缓存优化**：合理配置Cloudflare缓存策略