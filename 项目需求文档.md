# 学生管理系统 - 项目需求文档（基于实际实现）

## 项目概述

本项目是一个面向教师和学生的管理系统，主要用于教师管理学生信息、考试排名、学生标准和违规情况，同时为学生提供查看个人信息的平台。系统采用静态网页 + 数据文件的架构：
- **学生端**：纯静态网页，从JSON文件获取所有数据，可直接部署到公网
- **教师端**：本地应用，可将所有数据导出为JSON文件供学生端使用

### 项目规模与访问限制
- **适用规模**：仅用于100人左右的学生班级
- **访问限制**：仅允许教师本人的学生登录使用
- **部署要求**：
  - 学生端：纯静态网页，可直接部署到公网访问
  - 教师端：仅在本地电脑使用，无需发布到外网或公网

## 技术栈

### 前端技术
- **框架**：React 18+ with TypeScript
- **UI组件库**：Ant Design (TypeScript版本)
- **构建工具**：Vite
- **Excel处理**：SheetJS/xlsx库
- **路由管理**：React Router DOM
- **状态管理**：React Hooks (useState/useEffect)
- **开发工具**：ESLint + Prettier + TypeScript严格模式

### 数据存储
- **教师端**：本地数据管理，支持将所有数据导出为JSON文件
- **学生端**：从JSON文件获取所有数据
- **本地存储**：仅用于保存登录状态和用户角色

## 功能需求

### 1. 学生端功能

#### 1.1 登录页面
- **功能描述**：学生通过班级、姓名、学号登录系统
- **输入要求**：
  - 班级（必填）
  - 姓名（必填）
  - 学号（必填）
- **验证逻辑**：通过班级、姓名和学号进行精确查询验证

#### 1.2 个人信息查看页面
- **功能描述**：查看个人各项活动的标准
- **显示内容**：
  - 基本信息（班级、姓名、学号）
  - 各项标准名称及其对应的值（所有标准均创建即启用）
- **数据获取**：从JSON文件获取学生详细信息和标准设置
- **交互功能**：仅查看，无编辑权限

#### 1.3 违规情况查看页面
- **功能描述**：查看个人历史违规记录和核销情况
- **显示内容**：
  - 违规时间、类型
- **数据获取**：从JSON文件获取学生违规记录
- **数据组织**：按时间倒序排列

#### 1.5 个人考试排名查看页面
- **功能描述**：查看学生自己的所有考试排名记录，并显示排名进步退步情况
- **显示内容**：
  - 考试名称、考试日期、排名
  - 按考试创建时间排列（最新考试在前）
  - 包含所有考试的完整排名记录
  - 排名进步情况分析
    - **比较逻辑**：将最新的考试排名与前两次考试的最佳排名比较
    - **显示内容**：显示进步或退步的具体名次（如：进步了131名）
    - **连续退步标记**：注明是否连续退步了两次（如：连续退步）
    - **示例**：10月排名52，11月151，12月158。最新排名158与前两次最佳排名52比较，显示"退步了156名"，并标记"连续退步"
    - **数据不足处理**：如果考试次数不足3次，显示数据不足提示
- **数据获取**：从JSON文件获取学生的所有考试排名数据和考试排序
- **交互功能**：仅查看，无编辑权限

### 2. 教师端功能

#### 2.1 教师登录页面
- **功能描述**：教师通过用户名和密码登录系统
- **输入要求**：
  - 用户名（必填）
  - 密码（必填）
- **验证逻辑**：验证用户名和密码是否正确

#### 2.2 教师端布局
- **功能描述**：教师端统一的布局和导航
- **导航菜单**：
  - 班级管理
  - 学生信息管理
  - 考试排名管理
  - 学生标准查看
  - 学生标准管理
  - 学生违规情况管理
  - 预警管理
  - 数据导出

#### 2.3 班级管理页面
- **功能描述**：管理班级信息，支持班级的增删改查操作
- **功能模块**：
  - 班级列表展示（名称、学生数量）
  - 添加新班级
  - 编辑班级名称
  - 删除班级（含关联数据处理）
  - 班级选择组件动态加载
- **数据关联**：
  - 学生信息
  - 考试排名记录
  - 标准设置
  - 违规记录

#### 2.4 学生信息管理页面
- **功能描述**：查看和更新学生基本信息，支持批量操作，同时显示学生预警状态
- **功能模块**：
  - 学生列表展示
  - 基本信息编辑（班级、姓名、学号）
  - 按班级筛选
  - 按姓名或学号搜索
  - 单个学生删除（含关联数据）
  - 批量删除学生（含关联数据）
  - 查看学生详情
  - 支持多选、全选、反选操作
  - 批量操作统计显示
  - Excel导入学生数据
  - 新增学生信息
- **预警计算逻辑**：
  - **连续退步**：最近三次考试排名依次退步（最新排名 > 上一次排名 > 再上一次排名）
  - **累计违规2次以上**：学生累计违规记录达到或超过2次
  - **一次退步+一次违规**：学生至少有一次排名退步且至少有一次违规记录
- **数据处理**：
  - 支持从后端API获取学生数据
  - 表格排序功能通过API实现
  - 预警状态数据实时从后端获取，确保准确性

#### 2.5 学生排名管理页面
- **功能描述**：管理学生考试排名情况，支持Excel导入/导出和矩阵式排名展示
- **功能模块**：
  - Excel导入最新考试排名
    - 支持Excel文件上传
    - 手动输入考试名称、班级
    - 数据校验和预览
  - 矩阵式排名表格展示
    - 按考试名称筛选
    - 按班级筛选
    - 支持横向滚动查看多个考试排名
    - 每个学生一行，包含所有考试的排名
    - 支持分页功能，默认每页显示20条记录
    - 提供分页控件，支持页码跳转和每页显示条数调整
  - 排名数据管理
    - 支持按考试批量删除排名记录
  - 学生信息关联
    - 自动关联学生基本信息
    - 通过班级筛选学生排名
  - 学生排名筛选功能
    - 按进步情况筛选：全部/进步/退步/连续退步
    - 按前十名筛选：每个班级特定考试中排名最靠前的10个人
    - 直观显示每个学生的排名进步情况
    - 为不同进步情况添加颜色标识
    - 支持筛选结果统计

#### 2.6 学生标准查看页面
- **功能描述**：查看和直接编辑学生各项标准，支持多种筛选和搜索方式，同时支持批量修改标准值
- **功能模块**：
  - 按班级筛选
  - 按学生姓名或学号搜索
  - 矩阵式标准表格展示（按学生分组）
  - 动态生成标准名称列（所有标准名称均可增删改）
  - **直接编辑功能**：在表格中使用InputNumber组件直接修改标准值，限制1-5之间的整数输入
  - **批量选择功能**：
    - 全选/取消全选：一键选择或取消所有学生
    - 按班级选择：选择当前筛选班级的所有学生
    - 自定义选择：手动勾选需要修改的学生
  - **批量修改功能**：
    - 选择要修改的标准类型（标准类型来自标准管理页面的数据）
    - 设置统一的标准值（1-5之间的整数）
    - 批量应用：将设置的值应用到所有选中的学生
    - 一键选择符合条件的学生
  - **批量保存功能**：一次性保存所有选中学生的修改，减少重复操作
  - 实时保存：直接编辑时修改后自动保存到后端，无需额外确认
  - 批量操作提示：批量保存成功或失败后显示提示信息
  - 学生信息关联：自动关联学生基本信息
  - 支持横向滚动查看多个标准名称
  - 操作确认机制：批量修改前显示确认对话框，防止误操作

#### 2.7 学生标准管理页面
- **功能描述**：管理学生各项标准名称，支持所有标准名称的编辑、删除
- **功能模块**：
  - 查看所有标准名称
  - 添加新标准名称
    - 为所有学生自动批量创建新标准记录
    - 默认标准值为3
    - 创建即启用，无需手动启用
  - 修改现有标准名称
    - 批量更新所有学生的对应标准记录
  - 删除标准名称
    - 批量删除所有学生的对应标准记录
    - 包含确认对话框防止误操作
  - 标准名称列表展示
    - 支持直接编辑和删除操作
    - 显示操作状态提示

#### 2.8 学生违规情况管理页面
- **功能描述**：查看学生的违规记录，支持多维度筛选和统计
- **功能模块**：
  - **违规记录查看**
    - 按学生姓名、学号搜索筛选
    - 按班级筛选
    - 按违规类型筛选（支持模糊匹配）
    - 违规记录列表展示（时间倒序）


#### 2.9 预警管理页面
- **功能描述**：集中管理和展示学生预警信息，支持预警处理和分析
- **功能模块**：
  - **预警列表展示**
    - 按预警类型筛选（连续退步/累计违规/一次退步+一次违规）
    - 按班级筛选
    - 预警学生列表（包含学生基本信息和预警原因）


#### 2.10 数据导出页面
- **功能描述**：将所有系统数据导出为JSON文件，供学生端使用
- **功能模块**：
  - 一键导出完整数据包（包含所有数据的单个JSON文件）
  - 导出成功提示和文件下载

#### 2.11 学生详情页面
- **功能描述**：查看和管理学生完整信息
- **功能模块**：
  - 学生基本信息展示
  - 历史所有考试排名记录
  - 排名进步情况分析
    - **比较逻辑**：将最新的考试排名与前两次考试的最佳排名比较
    - **显示内容**：显示进步或退步的具体名次（如：退步了156名）
    - **连续退步标记**：注明是否连续退步了三次（如：连续退步）
    - **示例**：10月排名52，11月151，12月158。最新排名158与前两次最佳排名52比较，显示"退步了156名"，并标记"连续退步"
  - 标准详情编辑
    - 可直接修改标准值
    - 标准名称和标准值与标准查看页面完全一致
  - 违规记录管理
    - 新增违规记录
    - 删除违规记录
- **数据获取**：通过API从后端获取学生的标准数据，与标准查看页面保持一致

## 数据模型

### 1. 学生信息（Student）
- **id**: string - 学生唯一标识
- **class**: string - 班级
- **name**: string - 姓名
- **studentId**: string - 学号
- **createdAt**: Date - 创建时间
- **updatedAt**: Date - 更新时间

### 2. 考试排名（ExamRanking）
- **id**: string - 排名记录唯一标识
- **studentId**: string - 学生ID
- **examName**: string - 考试名称
- **ranking**: number - 排名
- **createdAt**: Date - 创建时间

### 3. 标准设置（Standard）
- **id**: string - 标准唯一标识
- **studentId**: string - 学生ID
- **name**: string - 标准名称（所有标准名称均可增删改）
- **value**: number - 标准值
- **createdAt**: Date - 创建时间
- **updatedAt**: Date - 更新时间

### 4. 违规记录（Violation）
- **id**: string - 违规记录唯一标识
- **studentId**: string - 学生ID
- **type**: string - 违规类型（手动填写）
- **violationDate**: Date - 违规时间
- **createdAt**: Date - 创建时间

## 页面路由

### 学生端路由
- `/student/login` - 学生登录页面
- `/student/profile` - 个人信息查看页面
- `/student/violations` - 违规情况查看页面
- `/student/rankings` - 个人考试排名查看页面

### 教师端路由
- `/teacher/login` - 教师登录页面
- `/teacher/classes` - 班级管理页面
- `/teacher/students` - 学生信息管理页面
- `/teacher/rankings` - 学生排名管理页面
- `/teacher/standards/view` - 学生标准查看页面
- `/teacher/standards/manage` - 学生标准管理页面
- `/teacher/violations` - 学生违规情况管理页面
- `/teacher/alerts` - 预警管理页面
- `/teacher/export` - 数据导出页面
- `/teacher/student/:id` - 学生详情页面

## 功能实现细节

### 1. 登录功能
- **学生登录**：使用班级、姓名、学号进行验证，从JSON文件中匹配
- **教师登录**：使用用户名和密码进行验证
- **登录状态管理**：使用localStorage存储登录状态和用户角色

### 2. 数据展示
- **表格组件**：大量使用Ant Design的Table组件展示数据
- **卡片组件**：用于展示统计信息和详情
- **矩阵式表格**：考试排名页面使用矩阵式表格展示多个考试的排名情况
- **响应式设计**：使用Row和Col组件实现响应式布局

### 3. 数据导入
- **Excel导入**：支持Excel文件上传和解析，使用SheetJS库
- **数据校验**：验证上传数据的格式和完整性
- **数据预览**：展示前5条数据用于预览确认
- **批量导入**：支持批量导入学生信息和考试排名数据

### 4. 筛选和搜索
- **多条件筛选**：支持按多种条件组合筛选数据
- **实时搜索**：输入时即时过滤数据
- **服务器端分页**：班级管理页面支持服务器端分页

### 5. 考试排序交互流程

#### 5.1 教师端排序操作流程
1. **加载考试数据**：
   - 教师访问排名管理页面时，前端从MySQL数据库获取考试列表
   - 从考试数据中提取唯一的考试名称，按创建时间降序排列
   - 最新创建的考试显示在最右侧，最旧的考试显示在最左侧

2. **显示考试列**：
   - 前端根据考试创建时间动态生成考试列


#### 5.2 学生端排名展示流程
1. **获取学生排名数据**：
   - 学生访问个人排名页面时，前端从JSON文件获取排名数据

2. **计算排名进步情况**：
   - 前端根据返回的排名数据计算进步情况
   - 比较逻辑：最新考试排名与前两次考试的最佳排名比较
   - 检查是否连续退步：比较最近三次考试的排名变化趋势

3. **展示排名和进步情况**：
   - 以表格形式展示所有考试的排名记录
   - 显示排名进步情况分析，包括：
     - 最新考试名称和排名
     - 与前两次考试最佳排名的比较结果
     - 进步或退步的具体名次
     - 是否连续退步的标记


## 测试账号

### 学生账号
- **班级**：高一(1)班
- **姓名**：张三
- **学号**：2024001

### 教师账号
- **用户名**：teacher
- **密码**：teacher123

### 测试说明
1. **教师登录**：使用教师账号登录后，可以访问所有教师端功能，包括考试排名管理、学生信息管理、标准管理等
2. **学生登录**：使用学生账号登录后，可以查看个人信息、违规情况和考试排名